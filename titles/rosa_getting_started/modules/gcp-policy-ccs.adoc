
[id="gcp-policy-ccs_{context}"]

= Required customer procedure

[role="_abstract"]
The CCS model allows Red Hat to deploy and manage OpenShift managed services into a customerâ€™s Google Cloud (GCP) project. Red Hat requires several prerequisites in order to provide these services.

[WARNING]
====
To use {product-title} in your GCP project, the GCP organizational policy constraint, `constraints/iam.allowedPolicyMemberDomains`, cannot be in place.
====

.Procedure

1. link:https://cloud.google.com/resource-manager/docs/creating-managing-projects[Create a Google Cloud project] to host the {product-title} cluster.
+
[NOTE]
====
The project name must be 10 characters or less.
====

2. link:https://cloud.google.com/service-usage/docs/enable-disable#enabling[Enable] the following required APIs in the project that hosts your {product-title} cluster:
+
.Required API services
[cols="2a,3a",options="header"]
|===
|API service |Console service name


|Cloud Deployment Manager V2 API
|`deploymentmanager.googleapis.com`


|Compute Engine API
|`compute.googleapis.com`

|Google Cloud APIs
|`cloudapis.googleapis.com`

|Cloud Resource Manager API
|`cloudresourcemanager.googleapis.com`

|Google DNS API
|`dns.googleapis.com`

|IAM Service Account Credentials API
|`iamcredentials.googleapis.com`

|Identity and Access Management (IAM) API
|`iam.googleapis.com`

|Service Management API
|`servicemanagement.googleapis.com`

|Service Usage API
|`serviceusage.googleapis.com`

|Google Cloud Storage JSON API
|`storage-api.googleapis.com`

|Cloud Storage
|`storage-component.googleapis.com`

|===

3. To ensure that Red Hat can perform necessary actions, you must create an `osd-ccs-admin` IAM link:https://cloud.google.com/iam/docs/creating-managing-service-accounts#creating_a_service_account[service account] user within the Google Cloud project.
+
The following roles must be link:https://cloud.google.com/iam/docs/granting-roles-to-service-accounts#granting_access_to_a_service_account_for_a_resource[granted to the service account]:
+
.Required roles
[cols="2a,3a",options="header"]

|===

|Role|Console role name

|Compute Admin
|`roles/compute.admin`

|DNS Admin
|`roles/dns.admin`

|Organizational Policy Viewer
|`roles/orgpolicy.policyViewer`

|Owner
|`roles/owner`

|Project IAM Admin
|`roles/resourcemanager.projectIamAdmin`

|Service Management Administrator
|`roles/servicemanagement.admin`

|Service Usage Admin
|`roles/serviceusage.serviceUsageAdmin`

|Storage Admin
|`roles/storage.admin`

|===

4. link:https://cloud.google.com/iam/docs/creating-managing-service-account-keys#creating_service_account_keys[Create the service account key] for the `osd-ccs-admin` IAM service account. Export the key to a file named `osServiceAccount.json`, this JSON file will be uploaded in OpenShift Cluster Manager (OCM) when you create your cluster.
